{"version":3,"sources":["index.ts"],"names":[],"mappings":"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","file":"src.6a732ddd.js","sourceRoot":"..\\src","sourcesContent":["function init() {\r\n    document.getElementById(\"generateButton\").addEventListener(\"click\", function() {\r\n        try {\r\n            generate();\r\n        } catch (e) {\r\n            alert(e);\r\n        }\r\n        return false;\r\n    });\r\n}\r\n\r\nfunction generate() {\r\n    let rawUsers = parseUsers();\r\n    let domain = document.forms[\"main_form\"][\"domain\"].value;\r\n    let genUsers = generateEmails(rawUsers, domain);\r\n\r\n    if (genUsers.length > 0) {\r\n        displayGeneratedInfo(genUsers);\r\n    }\r\n}\r\n\r\nfunction parseUsers() {\r\n    let lines = document.forms[\"main_form\"][\"users\"].value.split(\"\\n\");\r\n    let users = [];\r\n    let i = 0;\r\n    let badLines = [];\r\n    let alertMessages = [];\r\n    for (let line of lines) {\r\n        let trimmedLine = line.trim();\r\n        let unknowns = getUnknownTransliterate(trimmedLine.split(\"\\t\").slice(0,3).join(\"\\t\"));\r\n        if (unknowns.length > 0) {\r\n            badLines.push({\r\n                line: trimmedLine,\r\n                badSymbols: unknowns\r\n            });\r\n            continue;\r\n        }\r\n        if (trimmedLine.length > 0) {\r\n            let userPrefs = trimmedLine.split(\"\\t\");\r\n            if (userPrefs.length < 3) {\r\n                alertMessages.push(\"Лінійка \" + trimmedLine + \" не містить повної інформації\");\r\n                continue;\r\n            }\r\n            users[i] = {\r\n                group: userPrefs[0].trim(),\r\n                lastName: userPrefs[1].trim(),\r\n                firstName: userPrefs[2].trim(),\r\n                plainText: trimmedLine\r\n            };\r\n            if (userPrefs[3]) {\r\n                users[i].email = userPrefs[3].trim();\r\n                if (userPrefs[4]) {\r\n                    users[i].password = userPrefs[4].trim();\r\n                } else {\r\n                    alertMessages.push(\"Студент має існуючий імейл \" + users[i].email + \", але не має пароля!\");\r\n                }\r\n            }\r\n            i++;\r\n        }\r\n    }\r\n    if (alertMessages.length > 0) {\r\n        alert(alertMessages.join(\"\\r\\n\"));\r\n        return [];\r\n    }\r\n    if (badLines.length > 0) {\r\n        document.getElementById(\"badlinesroot\").classList = \"visible\";\r\n        for (let badLine of badLines) {\r\n            document.getElementById(\"badlines\").innerHTML += \"<p>\" + badLine.line + \" <b>Символи: </b> \" + badLine.badSymbols.join(\", \") + \"</p>\"\r\n        }\r\n    } else {\r\n        document.getElementById(\"badlinesroot\").classList = \"hidden\";\r\n        document.getElementById(\"badlines\").innerHTML = \"\";\r\n    }\r\n    return users;\r\n}\r\n\r\nfunction generateEmails(rawUsers, domain) {\r\n    let genUsers = [];\r\n    let allUsernames = [];\r\n    // First process everyone that already have emails\r\n    for (let rawUser of rawUsers) {\r\n        if (rawUser.email) {\r\n            rawUser.doNotTouch = true;\r\n            rawUser.username = rawUser.email.split('@')[0];\r\n            allUsernames.push(rawUser.username);\r\n            genUsers.push(rawUser);\r\n        }\r\n    }\r\n\r\n    // Then process new users\r\n    for (let rawUser of rawUsers) {\r\n        if (!rawUser.email) {\r\n            let username = transliterate(rawUser.group) + \".\" + transliterate(rawUser.lastName) + \".\" + transliterate(rawUser.firstName[0]);\r\n            username = username.toLowerCase();\r\n            let arrayCopy = rawUsers.slice();\r\n            username = generateUniqueUsername(allUsernames, username);\r\n            rawUser.username = username;\r\n            allUsernames.push(rawUser.username);\r\n            rawUser.password = randPassword(4,3,1,2);\r\n            rawUser.email = username + \"@\" + domain;\r\n            genUsers.push(rawUser);\r\n        }\r\n    }\r\n\r\n    // Double-check. Перевіряємо на однакові юзернейми знову\r\n    let alertMessages = [];\r\n    for (var i=0; i<genUsers.length-1; i++) {\r\n        for (var j=i+1; j<genUsers.length; j++) {\r\n            if (genUsers[i].email == genUsers[j].email) {\r\n                alertMessages.push(\"Знайдено кілька однакових імейлів: \" + genUsers[i].email);\r\n            }\r\n        }\r\n    }\r\n    if (alertMessages.length > 0) {\r\n        alert(alertMessages.join(\"\\r\\n\"));\r\n        return [];\r\n    }\r\n    return genUsers;\r\n}\r\n\r\nfunction generateUniqueUsername(allUsernames, username) {\r\n    if (allUsernames.indexOf(username) === -1) {\r\n        return username;\r\n    }\r\n    let uniqueUsername;\r\n    for (let i=2; i<100; i++) {\r\n        uniqueUsername = username + i;\r\n        if (allUsernames.indexOf(uniqueUsername) === -1) {\r\n            return uniqueUsername;\r\n        }\r\n    }\r\n    return username;\r\n}\r\n\r\nlet translitMap = {\r\n    '1': '1',\r\n    '2': '2',\r\n    '3': '3',\r\n    '4': '4',\r\n    '5': '5',\r\n    '6': '6',\r\n    '7': '7',\r\n    '8': '8',\r\n    '9': '9',\r\n    '0': '0',\r\n    'зг' : 'zgh',\r\n    'Зг' : 'Zgh',\r\n    'А':'A',\r\n    'а':'a',\r\n    'Б':'B',\r\n    'б':'b',\r\n    'В':'V',\r\n    'в':'v',\r\n    'Г':'H',\r\n    'г':'h',\r\n    'Ґ':'G',\r\n    'ґ':'g',\r\n    'Д':'D',\r\n    'д':'d',\r\n    'Е':'E',\r\n    'е':'e',\r\n    'Є':'Ye',\r\n    'є':'ie',\r\n    'Ж':'Zh',\r\n    'ж':'zh',\r\n    'З':'Z',\r\n    'з':'z',\r\n    'И':'Y',\r\n    'и':'y',\r\n    'І':'I',\r\n    'і':'i',\r\n    'Ї':'Yi',\r\n    'ї':'i',\r\n    'Й':'Y',\r\n    'й':'i',\r\n    'К':'K',\r\n    'к':'k',\r\n    'Л':'L',\r\n    'л':'l',\r\n    'М':'M',\r\n    'м':'m',\r\n    'Н':'N',\r\n    'н':'n',\r\n    'О':'O',\r\n    'о':'o',\r\n    'П':'P',\r\n    'п':'p',\r\n    'Р':'R',\r\n    'р':'r',\r\n    'С':'S',\r\n    'с':'s',\r\n    'Т':'T',\r\n    'т':'t',\r\n    'У':'U',\r\n    'у':'u',\r\n    'Ф':'F',\r\n    'ф':'f',\r\n    'Х':'Kh',\r\n    'х':'kh',\r\n    'Ц':'Ts',\r\n    'ц':'ts',\r\n    'Ч':'Ch',\r\n    'ч':'ch',\r\n    'Ш':'Sh',\r\n    'ш':'sh',\r\n    'Щ':'Shch',\r\n    'щ':'shch',\r\n    'ь':'',\r\n    'Ю':'Yu',\r\n    'ю':'iu',\r\n    'Я':'Ya',\r\n    'я':'ia',\r\n    '’': '',\r\n    '`': '',\r\n    '\\'': '',\r\n    ' ': '',\r\n    '-': ''\r\n}\r\n\r\nfunction transliterate(str) {\r\n    let result = '';\r\n    for (var i=0; i<str.length; i++) {\r\n        let translated = translitMap[str[i]];\r\n        if (translated !== '' && !translated) {\r\n            alert(\"Символа \" + str[i] + \" немає в мапі транслітерації, тому він додасться без змін.\")\r\n            translated = str[i];\r\n        }\r\n        result += translated;\r\n    }\r\n    return result.toLowerCase();\r\n}\r\n\r\nfunction getUnknownTransliterate(str) {\r\n    let unknowns = [];\r\n    for (var i=0; i<str.length; i++) {\r\n        let translated = translitMap[str[i]];\r\n        if (translated !== '' && !translated && str[i] !== '\\t') {\r\n            unknowns.push(str[i]);\r\n        }\r\n    }\r\n    return unknowns;\r\n}\r\n\r\nfunction randPassword(letters, numbers, specials, either) {\r\n    var chars = [\r\n        \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\", // letters\r\n        \"0123456789\", // numbers\r\n        \"!@#$%^&*()_+\", // special characters\r\n        \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\" // either\r\n    ];\r\n\r\n    return [letters, numbers, specials, either].map(function(len, i) {\r\n        return Array(len).fill(chars[i]).map(function(x) {\r\n            return x[Math.floor(Math.random() * x.length)];\r\n        }).join('');\r\n    }).concat().join('').split('').sort(function(){\r\n        return 0.5-Math.random();\r\n    }).join('')\r\n}\r\n\r\nfunction displayGeneratedInfo(genUsers) {\r\n    let text = '';\r\n    for (let genUser of genUsers) {\r\n        text += genUser.group + '\\t' + genUser.lastName + '\\t' + genUser.firstName + '\\t' + genUser.email + '\\t' + genUser.password + '\\n';\r\n    }\r\n    document.getElementById(\"generatedUsernames\").value = text;\r\n\r\n    document.getElementById(\"results\").classList = \"visible\";\r\n}\r\n\r\nwindow.onload = () => {\r\n    init();\r\n}"]}